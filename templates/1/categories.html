<?php if ($error_state) { ?>
<div class="border">
  <h3>@lang(re_error_title)</h3>
  <div class="bbody"><?php echo $lang->phrase(iif($hidden == 0, 'error_no_forums_found', 'error_no_forum_permissions')); ?></div>
  <?php if ($hidden > 0) { ?>
  <div class="bfoot">
    <label>@lang(logged_in_as)</label>{{ $my->name }}
  </div>
  <?php } ?>
</div>
<br class="minibr" />
<?php } else { foreach ($cats as $cat) { ?>
  <table class="tables">
    <thead>
	<tr>
		<th colspan="4">
			<img id="img_cat_f{{ $cat['id'] }}" alt="switch" src="@img(minus)" title="@lang(box_collapse)" /> {{ $cat['name'] }}
			<?php echo iif (!empty($cat['description']), '<br /><span class="stext">'.$cat['description'].'</span>'); ?>
		</th>
	</tr>
	</thead>
	<tbody id="part_cat_f{{ $cat['id'] }}">
	<tr class="tfoot">
		<td width="3%">&nbsp;</td>
		<td width="45%">@lang(board)</td>
		<td width="18%">@lang(contentcounter)</td>
		<td width="34%">@lang(last_post)</td>
	</tr>
    <?php foreach ($cat['forums'] as $forum) { if ($forum['opt'] == 're') { ?>
	<tr class="tbody">
		<td width="3%" class="center"><img src="@img(cat_redirect)" alt="{{ $forum['name'] }}" /></td>
		<td width="97%" colspan="3">
		<span class="right stext">{{ $forum['optvalue'] }}</span>
		<strong><a href="{{ $forum['optvalue'] }}">{{ $forum['name'] }}</a></strong>
		<?php echo iif (!empty($forum['description']), "<br />{$forum['description']}"); ?>
		</td>
	</tr>
	<?php } else { ?>
	<tr class="tbody">
		<td width="3%" class="center">
			<img<?php echo iif($forum['new'], ' title="'.$lang->phrase('forum_options_markread').'" onmouseover="HandCursor(this)" onclick="ajax_markforumread('.$forum['id'].',this)"'); ?> src="{{ $forum['foldimg'] }}" alt="{{ $forum['name'] }}" />
		</td>
		<td width="45%">
			<strong><a href="showforum.php?id={{ $forum['id'] }}{{ SID2URL_x }}">{{ $forum['name'] }}</a></strong>
			<?php echo iif (!empty($forum['description']), "<br />{$forum['description']}"); ?>
			<?php if (count($forum['mod'])) { ?>
			<br /><span class="stext">
			<strong>@lang(forum_mods)</strong>
			<?php foreach($forum['mod'] as $m) { ?>
			<a href="profile.php?id={{ $m['mid'] }}{{ SID2URL_x }}">{{ $m['name'] }}</a>{{ $m['sep'] }}
			<?php } ?>
			</span>
			<?php } ?><?php if(count($forum['sub'])) { ?>
			<br /><span class="stext">
			<strong>@lang(forum_subforums)</strong>
			<?php foreach ($forum['sub'] as $s) { ?>
			<br />
			<img<?php echo iif($s['new'], ' title="'.$lang->phrase('forum_options_markread').'" onmouseover="HandCursor(this)" onclick="ajax_markforumread('.$s['id'].',this,1)"'); ?> src="{{ $s['foldimg'] }}" alt="{{ $s['name'] }}" />&nbsp;
			<a href="<?php echo iif($s['opt'] != 're', 'showforum.php?id='.$s['id'].SID2URL_x, $s['optvalue']); ?>">{{ $s['name'] }}</a>
			<?php } ?>
			</span>
			<?php } ?>
		</td>
		<td width="18%">
			{{ $forum['topics'] }} @lang(xtopics)<br />
			{{ $forum['replies'] }} @lang(xreplies)
		</td>
		<td width="34%" class="stext">
		<?php if(!empty($forum['l_topic'])) { ?>
			<a title="{{ $forum['l_topic_full'] }}" href="showtopic.php?id={{ $forum['l_tid'] }}{{ SID2URL_x }}&amp;action=last">
			<strong>{{ $forum['l_prefix'] }}{{ $forum['l_topic'] }}</strong>
			</a><br />
			<span class="left nowrap">
			@lang(by)
			<?php echo iif ($forum['l_name'][1], '<a href="profile.php?id='.$forum['l_name'][1].SID2URL_x.'">'.$forum['l_name'][0].'</a>', $forum['l_name'][0]); ?>
			</span>
			<span class="right nowrap">{{ $forum['l_date'] }}</span>
		<?php } else { echo $lang->phrase('cat_no_lastpost'); } ?>
		</td>
	</tr>
	<?php } } ?>
	</tbody>
  </table>
<?php } } ?>